<!-- cria uma tabela -->
<table id="tabelaAlunos" border="1">
    <!-- cabeçalho da tabela -->
    <thead>
        <link rel="stylesheet" href="style.css">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </thead>
    <!-- corpo da tabela -->
    <tbody>
        <!-- Linhas preenchidas pelo JavaScript -->
    </tbody>
</table>
<a href="index.html"><button type="button">Lista de alunos</button></a>
<h3>Atualizar informações do Aluno</h3>
Nome:
<input type="text" id="nome" name="nome" value="">
<br>
Nascimento:
<input type="date" id="nascimento" name="nascimento" value="">
<br>
Telefone:
<input type="text" id="telefone" name="telefone" value="">
<br>
Endereço:
<input type="text" id="endereco" name="endereco" value="">
<br>
<input type="hidden" name="acao" value="inserir">
<button onclick="atualizar()">atualizar</button>

<script>
    var token = "65759b9ecf9e4ea4828e5d900361ff09";
    // pegar os parametros da URL
    const parametros = new URLSearchParams(window.location.search);
    // pegar o valor do parametro id
    var id = parametros.get("id")
    var nome = parametros.get("nome")
    var tel = parametros.get("tel")
    var end = parametros.get("end")
    var data = parametros.get("data")
    // colocar os valores nos campos
    document.getElementById('nome').value = nome
    document.getElementById('telefone').value = tel
    document.getElementById('endereco').value = end
    document.getElementById('nascimento').value = data

    function atualizar() {
        var token = "65759b9ecf9e4ea4828e5d900361ff09";

        const params = new URLSearchParams(window.location.search);
        var pessoa = params.get('id') || '';
        console.log("ID da pessoa:", pessoa);

        //  Exemplo de requisição PUT para atualizar uma pessoa existente
        fetch("https://crudcrud.com/api/" + token + "/pessoas/" + id, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                nome: document.getElementById('nome').value,
                nascimento: document.getElementById('nascimento').value,
                endereco: document.getElementById('endereco').value,
                telefone: document.getElementById('telefone').value
            })
        })
            .then(() => console.log("Pessoa atualizado com sucesso"))
            .catch(error => console.log(error))
            .finally(() => {
                // redirecionar para a pagina inicial
                setTimeout(window.location.href = "index.html", 2000);

            });
    }

    function cadastrar() {
        fetch("https://crudcrud.com/api/" + token + "/pessoas", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                nome: document.getElementById('nome').value,
                nascimento: document.getElementById('nascimento').value,
                endereco: document.getElementById('endereco').value,
                telefone: document.getElementById('telefone').value
            })
        })
            .then(response => response.json())
            .then(data => console.log("Pessoa criada:", data))
            .catch(error => console.error("Erro no POST:", error))
            .finally(() => {
                setTimeout(() => {
                    window.location.href = "index.html";
                }, 2000);
            });
    }
</script>